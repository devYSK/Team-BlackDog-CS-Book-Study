## 개체 관계 모델

피터 첸이 제안한 것으로 개체와 개체 간의 관계를 이용하여 표현하는 방법

### 엔티티(개체)

- 저장할 가치가 있는 중요한 데이터
- 속성을 지닌 데이터

### 속성

- 엔티티가 가지고 있는 고유한 정보, 특성

엔티티 고객

속성 이름, 주소, 연락처, 적립금

### 관계

개체와 개체가 맺고 있는 의미 있는 연관성

### 관계의 유형

관계는 다양한 기준으로 분리될 수 있다.

### 매핑 원소의 수에 따른 분류

관계를 맺는 두 개체 집합에서 한 개체가 연관성을 가지는 상대 개체 인스턴스 개수를 말한다.

### 일대일 관계

남편과 아내 사이에는 혼인이라는 관계가 존재한다고 할 때

남편은 반드시 한 명의 아내와 만 혼인 관계를 가지고

아내도 반드시 한 명의 남편과 혼인 관계를 가집니다.

![일대일](https://user-images.githubusercontent.com/82176176/203272615-3c2f3456-663e-44ff-a06d-4fc3aa7dace9.PNG)


### 일대다 관계

축구팀과 축구 선수에서 계약 관계가 존재한다고 할 때

축구팀은 여러 명의 축구 선수와 계약 관계를 가질 수 있지만

축구선수는 한 개의 축구팀과 계약 관계를 가집니다.

![일대다](https://user-images.githubusercontent.com/82176176/203272642-1ecb4d1e-f858-4e69-81ed-19ab6d21f33a.PNG)


### 다대다 관계

학생과 스터디가 참여 관계가 존재할 때

학생은 여러 개의 스터디에 참여할 수 있고 

스터디도 여러 명의 학생이 참여할 수 있습니다.

![다대다](https://user-images.githubusercontent.com/82176176/203272664-6097761f-ee5a-488c-a209-affbeb388062.PNG)


## 관계 데이터 모델

### 릴레이션

데이터베이스 정보를 저장하는 기본 단위
| 고객 아이디 | 이름 | 등급 |
| --- | --- | --- |
| 1 | 건우 | 플레티넘 |
| 2 | 기서 | 다이아 |
| 3 | 영지 | 챌린저 |

### 릴레이션 스키마

릴레이션의 이름과 릴레이션의 포함된 모든 속성의 이름으로 릴레이션의 논리적 구조이다.

릴레이션 스키마 

- 고객( 고객 아이디, 이름, 등급)

### 릴레이션 인스턴스

속성들이 실제 값을 가진 튜플들의 집합

릴레이션 인스턴스

- 1, 건우, 플래티넘
- 2, 기서, 다이아
- 3, 영지, 챌리저

### 속성(필드)

릴레이션 열을 속성 또는 애트리뷰트라고 한다.

파일 관리 시스템에서는 필드와 대응되는 개념이다.

속성 : 고객 아이디, 이름, 등급

### 튜플(레코드)

릴레이션 행을 튜플이라고 한다.

파일 관리 시스템에서 레코드와 대응되는 개념이다.

튜플 : 1, 건우, 플래티넘

### 도메인

속성 하나가 가질 수 있는 모든 값의 집합

이름이나 아이디는 도메인을 정의하기 어렵다.

이렇게 특정하기 어려운 경우 데이터 타입을 도메인으로 한다.

이름 도메인 : CHAR(10)

등급 도메인 : 브론즈, 실버,  골드….챌린저

## 키

릴레이션에서 튜플은 다른 튜플들과 구분되기 위해 속성을 이용한다.

튜플들 구별해 주는 속성 또는 속성 집합을 키라고 한다.

키는 기본 키, 외래 키, 후보 키, 슈퍼 키, 대체 키가 있다.

### 슈퍼 키(Super Key)

유일성을 만족하는 속성 또는 속성 집합이다.

예시에서 고객 아이디는 값이 다르기 때문에 슈퍼 키가 된다.

이름은 동명이인이 존재할 수 있기 때문에 불가능하고

같은 등급에 사람이 얼마든지 존재할 수 있어 불가능하다.

슈퍼키는 속성 집합또한 가능하기 때문에 (고객 아이디, 고객이름)도 슈퍼키가 될 수 있다.

이러한 슈퍼키는 불필요한 속성값까지 확인하여 비효율적인 작업을 할 수 있다.

### 후보 키(Candidate Key)

유일성과 최소성을 만족하는 속성 또는 속성 집합이다.

튜플이 유일하게 구별하기 위한 최소한의 속성들로 이루어진다.

하나의 속성의 키는 후보키를 만족한다.

(고객 아이디, 고객이름)은 후보 키가 될 수 없다.

고객 아이디만으로도 유일성을 만족할 수 있기 때문이다.

### 기본키(Primary Key)

여러 개의 후보 키중 기본적으로 사용할 키를 기본 키라 한다.

기본 키를 선택할 때 고려해야 하는 기준

- 널 값을 가져서는 안 된다.
- 값이 자주 변경되어서는 안된다.
- 단순한 값을 선택한다.
- 

### 대체 키(Alternate Key)

기본 키로 선택되지 못한 후보 키들이다.

### 외래 키(Foreign key)

다른 릴레이션의 기본 키를 참조하는 속성이다.

## 무결성

무결성은 데이터에 결함이 없는 상태이다. 

### 개체 무결성 제약 조건

기본 키를 구성하는 속성은 널 값을 가질 수 없다.

튜플들을 구분해 주는 기본 키가 널 값이면 튜플의 유일성을 판달할 수 없다.

기본 키인 아이디 값이 null이면 이건우가 같은 사람인지 동명 이인인지 알 수 없다.
| 고객 아이디 | 고객 이름 | 참여 스터디 |
| --- | --- | --- |
| null | 이건우 | CS |
| null | 이건우 | 디자인 패턴 |

### 참조 무결성 제약 조건

외래 키가 참조할 수 없는 속성 값을 가져서는 안 된다.

외래 키는 기본 키값으로 존재하는 값을 가져야 참조가 가능하다. 

존재하지 않는 값을 가지면 릴레이션을 연관할 수 없어 외래 키의 의미가 없어진다.

외래 키는 꼭 참조 가능한 값만 가저야 한다.

| 아이디 | 이름 |
| --- | --- |
| gw0215 | 이건우 |
| rlarltj | 김기서 |

| 스터디 | 참여자 아이디 |
| --- | --- |
| CS | gw0215 |
| 디자인 패턴 | kratos123 |

참여자 아이디는 외래 키이다. 하지만 kratos123이라는 값이 참조 가능한 값이 아니다.

외래 키는 널 값이어도 참조 무결성 제약조건을 위반한 것으로 볼 수 없다.

참조되는 릴레이션의 튜플을 삭제하기 위해서는 참조하는 릴레이션의 튜플도 삭제해야 한다.

| 아이디 | 이름 |
| --- | --- |
| rlarltj | 김기서 |

김기서를 삭제하고싶다. 하지만 불가능하다.

| 스터디 | 참여자 아이디 |
| --- | --- |
| CS | gw0215 |
| 디자인 패턴 | rlarltj |

김기서를 참조하는 모든 릴레이션을 제거해야 제거할 수 있다.

참조되는 릴레이션의 기본 키 속성값을 변경하려면 참조하는 릴레이션의 외래 키값도 함께 변경해야 한다.

| 아이디 | 이름 |
| --- | --- |
| gw980215 | 이건우 |        
| rlarltj | 김기서 |

이건우의 아이디를 변경하였다.(gw980215)

| 스터디 | 참여자 아이디 |
| --- | --- |
| CS | gw0215 |              
| 디자인 패턴 | rlarltj |

외래 키도 변경해 주어야 한다!(gw0215)

## 숫자타입

| 타입 | 정의 | 범위 | UNSIGNED 사용가능 여부 |
| --- | --- | --- | --- |
| TINYINT(n) | 정수형 데이터 타입 | 1 Byte(2^8)                                              -128 ~ + 127 또는 0 ~ 255 수 표현 가능   | O |
| SMALLINT(n) | 정수형 데이터 타입 | 2 Byte(2^16)                                               - 32,768 ~ 32,167 또는 0 ~ 65536수 표현 가능 | O |
| MEDIUMINT(n) | 정수형 데이터 타입 | 3 Byte                                                         - 8,388,608 ~ 8,388,607 또는 0 ~ 16,777,215 수 표현 가능 | O |
| INT(n) | 정수형 데이터 타입 | 4 Byte                                                          - 2,147,483,648 ~ 2,147,483,647 또는 0 4,294,967,295 수 표현 가능 | O |
| BIGINT(n) | 정수형 데이터 타입(LONG) | 8 byte                                                        - -2^63~2^63-1 또는 2^64 | O |

### UNSIGNED 속성

숫자형 데이터 타입에서 해당 값에 음수를 대입하지 못합니다.

음수값을 부여하면 최대값이 두배로 증가합니다.

## 문자 타입

| 타입 | 정의 | 범위 |
| --- | --- | --- |
| CHAR(n) | 고정 길이 데이터 타입                   지정된 길이보다 짧은 데이터 입력 시 나머지 길이는 공백으로 채워짐 | 0 ~ 255 (byte) |
| VACHAR(n) | 가변 길이 데이터 타입                   지정된 길이보다 짧은 데이터 입력시 공백으로 채우지 않음 | 0 ~ 65,535 (byte) |

## 날짜 타입

| 타입 | 정의 | 크기 | 형식 |
| --- | --- | --- | --- |
| DATE | 날짜(년도, 월, 일) 형태의 기간 표현 데이터 | 3 byte | 0000-00-00 (YYYY-MM-DD) |
| DATETIME | 날짜와 시간 형태의 기간 표현 데이터 | 8 byte | 0000-00-00 00:00:00 (YYYY-MM-DD hh:mm:ss) |
| TIMESTAMP | 날짜와 시간 형태의 기간 표현 데이터 타입 시스템 변경 시 자동으로 그 날짜와 시간이 저장 | 4 byte | 0000-00-00 00:00:00 (YYYY-MM-DD hh:mm:ss) |

TimeStamp은 타임존이 달라지면 시간대를 보정하여 준다.

```sql
create table timezone(
t_stamp timestamp
);
insert into timezone values(now());
set time_zone ='-09:00';
select * from timezone;
```

## TEXT와 BLOB

TEXT 와 BLOB은 대량의 데이터를 저장할때 사용하는 타입이다.

| 타입 | 정의 | 범위 |
| --- | --- | --- |
| TEXT(n) | - 문자열 데이터 타입(최대 65,535 byte)- BLOB와 같은 길이값을 저장 가능(단 차이점은 저장 될때 nonbinary string으로 저장) | 0 ~ 65,535 (byte) |
| BLOB(n) | 이진 데이터 타입 | 0 ~ 65,535 (byte |

## ENUM와 SET

ENUM과 SET는 모두 MySQL 내부적으로 숫자 값으로 매핑해서 관리하는 타입입니다. 

SET은 속성이 다중속성 값을 가질 수 있다.
